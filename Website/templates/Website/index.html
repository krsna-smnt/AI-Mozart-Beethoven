{% extends 'Website/base.html' %}

{% block title %}
	<title>Music</title>
{% endblock %}

{% block content %}

<div class="container">
	<div class='row'>
		<div class='col-lg-6'>
			<div class="panel panel-default">
				<div class='panel-heading'>
					<h3>Upload a file</h3>
				</div>

				<div class="panel-body">
					<form method="post" action="{% url 'index' %}" name='musicform' enctype="multipart/form-data">
					{% csrf_token %}
						<p>{{ form.non_field_errors }}</p>
		        	    
		        	    <p>
    		        	    {{ form.audio.errors }}
    		        	    {{ form.audio.label_tag }}
        		        	{{ form.audio }}
            			</p>

					<button type="submit" value='Upload' class="btn btn-primary btn-block">Add Music</button>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>

{% for song in audios %}
<div class="container">
	<div class="row">
		<h3><span id="MIDIjs.message" style="color: green">Initializing ...</span></h3>
	</div>
	<div class="row">
		{% if song %}
		<button id='butt' class='btn btn-success' onClick="operate()">Play</button>
		{% endif %}
	</div>
</div>
{% endfor %}

	<script type='text/javascript' src='http://www.midijs.net/lib/midi.js'></script>
	<script type="text/javascript">
		function operate()
		{
			if($('#butt').text() == 'Play')
			{
				MIDIjs.play('{{ song.audio.url }}');
				$('#butt').removeClass('btn-success');
				$('#butt').addClass('btn-danger');
				$('#butt').text('Stop');
			}
			else
			{
				MIDIjs.stop();
				$('#butt').removeClass('btn-danger');
				$('#butt').addClass('btn-success');
				$('#butt').text('Play');	
			}
		}
	</script>

{% endblock %}